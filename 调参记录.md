
## 2018华为软件精英挑战赛调参记录

两种装箱方案，一种FFD, 一种遗传算法;目前来看，遗传算法大多时间是优于FFD的。最后换用的了动态规划；
关于装箱，还有一种骚操作，根据最后一台服务器的资源利用率，修改之前预测情况，删除或者填满，均可以或多或少提升。

具体方案是：

1. 依次对每个规格的预测值进行减1或者减2操作，分别计算装箱个数，当箱子个数减少时，果断返回当前结果；此种情况针对最后一台服务器恰好为一台或者两台时，修该预测值，去掉最后一台服务器；

2. 当上面方法失效时，进入2；说明最后一台服务器装得差不多了，这个时候填满他；

### 方案一 timeRegular1

直接最后N天和作为预测值，进行装箱；到时候线上必然出现相同分数，可以作为参考值；

采用滑窗方法往前滑动2天，得到3个值求平均。

#0001 - 最后N天，线上结果74.713，骚操作：81.097    239.545

#0004 - 最后N天，往前滑动2次，融合（6：3：2），线上结果80.069， 骚操作：82.815 

### 方案二 timeRegular2

根据每个flavorX规格进行周期因子提取

后10天均值，周期因子为融合因子(5:5), 线上结果79.116, 加骚操作： 81.959。

### 方案三 timeRegular3

将flavor1-flavor15总和， 进行周期因子提取，再根据待预测类别后10天去除周期因子后的均值，进行预测； （结果总体要偏大一些，因为提取的是总体的因子）

周期因子包括： 中位数因子，均值因子，以及他们两融合因子(6:4)

- flavor1-flavor15总和， 后10天均值，周期因子为融合因子(5:5), 线上结果76.706, 加骚操作： 80.124。

- flavor1-flavor15总和， 后10天均值，周期因子为融合因子(6:4), 线上结果77.96，加骚操作： 80.311。

- flavor1-flavor15总和， 后10天均值，周期因子为融合因子(5.5:4.5), 线上结果78.503，加骚操作： 80.133 。

- flavor1-flavor15总和， 后10天均值，周期因子为融合因子(5.5:4.5), 加滤波(阈值2.0, 降低0.65)， 线上结果 77.019，骚操作：80.318 。

- flavor1-flavor15总和， 后10天均值，周期因子为融合因子(6:4), 加滤波(阈值2.0, 降低0.65)， 线上结果76.984， 骚操作：80.546。

- flavor1-flavor15总和， 后10天均值，周期因子为中位数因子, 线上结果78.515， 骚操作：81.42。

- flavor1-flavor15总和， 后10天均值，周期因子为均值因子,  线上结果72.965， 骚操作： 76.926。
 	
- flavor1-flavor15总和， 后10天均值，周期因子为融合因子(5:5)，融合了方案一的结果(0.35:0.7), 线上结果 78.405 骚操作： 81.701 （遗传算法：78.405 骚操作：83.587）

### 方案四 timeRegular4

一次指数平滑, 看原理是和时间序列(加了距离权重)规则一样的 预测公式错了，但是分好像更高一些， S(t+1) = (1- alpha) * S(t) + Y(t)

前3个t时期求均值， alpha=0.5, 线上结果：77.361

前3个t时期求均值， alpha=0.3, 线上结果：66.262

前3个t时期求均值， alpha=0.6, 线上结果：79.415

#0002 前3个t时期求均值， alpha=0.63, 线上结果：79.956 加骚操作  82.805 ， 线上结果，243.798

正常公式来做：S(t+1) = (1- alpha) * S(t) + alpha * Y(t)

前2个t时期求均值， alpha=0.63, 线上结果：73.878 加骚操作  79.328

#0003 前3个t时期求均值， alpha=0.63, 骚操作(内存大的减少其预测值数量)， 线上结果， 243.445

#0005 (错误公式) 前3个t时期求均值， alpha=0.63, 乘以了一个1.05 骚操作， 线上结果，240.605
### 方案五，上述方法融合



#################################### 2018-04-14 ####################################
1. timeRegular1 最后N天 + 骚操作 线上分数：239.545
2. 前3个t时期求均值， alpha=0.63, 骚操作， 线上结果，243.798
3. 前3个t时期求均值， alpha=0.63, 骚操作(内存大的减少其预测值数量)， 线上结果， 243.445
4. 最后N天，往前滑动2次，融合（6：3：2）线上结果, 241.975
5. (错误公式) 前3个t时期求均值， alpha=0.63, 乘以了一个1.05 骚操作， 线上结果，240.605

#################################### 2018-04-14 ####################################

#################################### 2018-04-15 ####################################
1. timeRegular3	flavor1-flavor15总和， 后10天均值，周期因子为融合因子(5:5)，融合了方案一的结果(0.35:0.7)线上结果：244.273
2. flavor1-flavor15总和， 后10天均值，周期因子为融合因子(5:5)，融合了方案一的结果(0.35:0.7), （遗传算法：78.405 骚操作：83.587）241.329
3. timeRegular3	flavor1-flavor15总和， 后10天均值，周期因子为融合因子(5:5)，融合了方案一的结果(0.35:0.7)线上结果：244.273
4. 
5. 
#################################### 2018-04-15 ####################################

#################################### 2018-04-23 复赛 ###############################
1. timeRegular3 
- 总申请量提取周期因子， 后10天均值，周期因子为融合因子(5:5), 线上结果-, 加骚操作：65.168。
- 总申请量提取周期因子， 后10天均值，周期因子为融合因子(5:5), 加滤波0.85，线上结果-, 加骚操作：65.518。
- 总申请量提取周期因子， 后10天均值，周期因子为融合因子(5:5), 加滤波0.75，线上结果-, 加骚操作：65.269。
- 总申请量提取周期因子， 后10天均值，周期因子为融合因子(5:5), 加滤波0.65，线上结果-, 加骚操作：65.468。
- 总申请量提取周期因子， 后10天均值，周期因子为融合因子(5:5), 加滤波0.55，线上结果-, 加骚操作：68.807。
- 总申请量提取周期因子， 后10天均值，周期因子为融合因子(5:5), 结果+(test.deltaDate / 7) * 35，线上结果-, 加骚操作：69.427。
- 总申请量提取周期因子， 后10天均值，周期因子为融合因子(5:5), 结果+ 35，线上结果-, 加骚操作：68.588。
- 总申请量提取周期因子， 后10天均值，周期因子为融合因子(5:5), 结果+ 40，线上结果-, 加骚操作：68.675。
- 总申请量提取周期因子， 后10天均值，周期因子为融合因子(5:5), 结果+ 50，线上结果-, 加骚操作：68.751。
- 总申请量提取周期因子， 后10天均值，周期因子为融合因子(5:5), 结果+ 60，线上结果-, 加骚操作：68.675。

2. timeRegular2
- 各个虚拟机单独提取周期因子，后10天均值，周期因子为融合因子(5:5), 线上结果64.669， 加骚操作：65.424     复赛：171 (很尴尬啊！)
- 各个虚拟机单独提取周期因子，后10天均值，周期因子为融合因子(5:5), 结果+(test.deltaDate / 7) * 35，线上结果， 加骚操作：70.376
- 各个虚拟机单独提取周期因子，后10天均值，周期因子为融合因子(5:5), 结果+ 35，线上结果， 加骚操作：68.941
- 各个虚拟机单独提取周期因子，后5天均值，周期因子为融合因子(5:5), 线上结果-， 加骚操作：60.359
- 各个虚拟机单独提取周期因子，后7天均值，周期因子为融合因子(5:5), 线上结果-， 加骚操作：63.294
- 各个虚拟机单独提取周期因子，后10天均值，周期因子为融合因子(5:5), 线上结果64.669， 加骚操作：65.424
- 各个虚拟机单独提取周期因子，后10天均值，周期因子为融合因子(5:5), 结果中超过100的，直接变为50, 线上结果-， 加骚操作：32.353 
- 各个虚拟机单独提取周期因子，后10天均值，周期因子为融合因子(5:5), 结果中超过100的，直接变为50, 线上结果-， 加骚操作：37.52
- 各个虚拟机单独提取周期因子，后10天均值，周期因子为融合因子(5:5), 结果中超过100的，直接变为100, 线上结果-， 加骚操作：41.486
- 各个虚拟机单独提取周期因子，后10天均值，周期因子为融合因子(5:5), 结果中超过100的，乘以1.1, 线上结果-， 加骚操作：64.476
- 各个虚拟机单独提取周期因子，后10天均值，周期因子为融合因子(5:5), 结果中超过200的，直接变为200, 线上结果-， 加骚操作：53.473
- 各个虚拟机单独提取周期因子，后10天均值，周期因子为融合因子(5:5), 结果中超过200的，乘以1.1, 线上结果-， 加骚操作：63.956
- 各个虚拟机单独提取周期因子，后10天均值，周期因子为融合因子(5:5), 结果中超过300的，直接变为300, 线上结果-， 加骚操作：62.013
- 各个虚拟机单独提取周期因子，后10天均值，周期因子为融合因子(5:5), 结果中超过400的，直接变为400, 线上结果-， 加骚操作：62.806
- 各个虚拟机单独提取周期因子，后10天均值，周期因子为融合因子(5:5), 结果中超过400的，乘以1.1, 线上结果-， 加骚操作：63.956
- 各个虚拟机单独提取周期因子，后10天均值，周期因子为融合因子(5:5), 结果中超过400的，乘以1.3, 线上结果-， 加骚操作：62.277

    if (reqFlavor[i] > 500)  // 该段代码可以到77.478
      reqFlavor[i] = (int)(reqFlavor[i] * 0.5);
    else if (reqFlavor[i] > 400) // 该区段没有影响，400-500之间无数值
      reqFlavor[i] = (int)(reqFlavor[i] * 0.55);
    else if (reqFlavor[i] > 300) // 该区段没有影响，300-400之间无数值
      reqFlavor[i] = (int)(reqFlavor[i] * 0.55);
    else if (reqFlavor[i] > 200) // 该区段没有影响，200-300之间无数值
      reqFlavor[i] = (int)(reqFlavor[i] * 0.45);
    else if (reqFlavor[i] > 90)
      reqFlavor[i] = (int)(reqFlavor[i] * 0.5);
    else if (reqFlavor[i] > 50)
      reqFlavor[i] = (int)(reqFlavor[i] * 2.35);
    else
      reqFlavor[i] = (int)(reqFlavor[i] * 2.2);

3. timeRegular4 一次指数平滑（正常公式）
- alpha = 0.63  线上结果：62.33
- alpha = 0.4   线上结果：63.741
- alpha = 0.3   线上结果：65.735
- alpha = 0.25  线上结果：66.955
- alpha = 0.23  线上结果：67.214
- alpha = 0.225 线上结果：67.273
- alpha = 0.22  线上结果：67.68
- alpha = 0.22 加滤波(4.0 0.95) 线上结果：67.72
- alpha = 0.21  线上结果：67.459
- alpha = 0.2   线上结果: 67.495
- alpha = 0.15  线上结果：65.4
- alpha = 0.1   线上结果：61.35

4. timeRegular1 均值
64.9  65.1
#################################### 2018-04-23 复赛 ###############################
## 线下结果测试
timeRegular4 
139
flavor1 28
flavor2 34
flavor4 6
flavor5 25
flavor8 46

timeRegular2
183
flavor1 30
flavor2 49
flavor4 8
flavor5 36
flavor8 60

High-Performance 4
High-Performance-1 flavor1 6 flavor2 12 flavor4 1 flavor5 14 flavor8 13 
High-Performance-2 flavor1 12 flavor2 13 flavor4 1 flavor5 10 flavor8 14 
High-Performance-3 flavor1 4 flavor2 10 flavor4 2 flavor5 7 flavor8 17 
High-Performance-4 flavor1 8 flavor2 14 flavor4 4 flavor5 5 flavor8 16 


### 真实结果
最后3个均值：timeRegular1: 170.837
一次指数平滑：timeRegular4: 154.23

















