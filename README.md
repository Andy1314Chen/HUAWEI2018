# HUAWEI2018
2018HUAWEI软件精英挑战赛

## 写在前面的话
昨天(2018-04-27)下午结束了复赛， 没能进入赛区前4强。其实原本也没有打算进前4，想着打个TOP10也就行啦，但是最终排名上合赛区18名。还是有些失望的，毕竟时间序列预测类比赛之前也是做了好几个了，也有了一些研究。还是对这个比赛做一些总结吧！

## 初赛
大约3月份看到今年华为软挑赛题出来，赛题目的是预测未来一段时间的虚拟机请求量，并给出合理的分配方案。明显预测部分要用机器学习方法来做，后面分配用传统算法解决。([赛题介绍](http://codecraft.devcloud.huaweicloud.com/home/detail))

首先解决的是后面的分配，参考了网上的FFD, Best Fit等方案，预测部分每种flavor都填上一个固定的数(好像是63和55吧，直接就能上80多了，很是扯淡啊。。。). 当时榜上有分的队伍不是很多，也算是当时的Top5吧，后来用时间序列规则搞了一下预测部分，直到初赛正式赛开始，也一直能保持在上合赛区TOP10. 因为之前排名靠前，加上对时间序列问题有过一些浅显的研究，同时也研究了线下提供的练习数据。2015年几个月份的请求数据，2016年1月，2月的请求数据，通过分析，只能发现每天的总请求量和，大约呈现周期性规律，而单个虚拟机的历史请求量并没有规律，而且中间还有很多0值，严格讲这种序列不太符合常见时间序列的定义。但是预测部分其实是对未来N天的总和进行预测，就是每一天预测的准确性是不管的，只要总和正确就行。这明显降低了预测难度，因此时间规则更能发挥作用。 

初赛正式赛第一次提交，用了最后N天的和直接作为预测值，动态规划分配，取得了239.5的分数。从后来的排名看，第一次就取得了16名。后来换了一个一次指数平滑进行预测，其实这个公式是写错了(St+1 = (1-alpha)*St + alpha*Yt, 后一项的系数忘记乘上了，但结果要比正确公式高很多，这也说明了这个比赛是有多么不靠谱！)，但结果要比正确公式分要高，可以到243.798. 最后也是凭借这个分以赛区第7名进入复赛。

## 复赛
复赛相对于初赛的变化， 分配阶段多了两种服务器规格，就是装箱部分有了3种服务器规格。刚开始我们查找了一些论文，博客，认为和初赛不同，是一个多背包问题，要用一种不同的方法来做。但是后来发现，根据贪心算法，每次选3种服务器都试一试，选择装得利用率最高的。也能取得95%的利用率。预测部分，仍然采用初赛的路子，继续时间序列规则来做，但是一直没有上分。总是60或者65左右，后来发现某种flavor请求量非常大，而且第3个用例，对结果影响很大，可以提高10分左右，因此，最高时可以达到77。榜上很多大佬，直接调到了80+，最后几天西北赛区、东北赛区甚至调到了90+，可以说是非常过拟合了。当时的想法是，复赛正式赛肯定是要换数据的，如果过度拟合练习赛的数据，正式赛就肯定会崩，然后抱着这种心态一直在优化65左右的方案。 但后来复赛正式赛期间，其实是我们崩了，复赛训练数据应该是没有变的，而且之前练习赛的用例怕是也没有变，直接增加了高级用例。相当于，比赛一开始，他们就比我们高了20分！后来东北赛区大佬尽然搞到了274，假如分配部分可以100%的话，其实分配影响不大，那么预测部分搞到了90%，这是很夸张的。因为线下数据来看，预测准确度不可能是达到这么高的，具有明显周期性的时间序列可能也无法得到这么高的准确率。后来根据西北赛区一位大佬透漏，确实是4个用例没有更换，训练数据也没有更换，利用之前每天100次的机会，几乎把4个用例的真实值都猜测出来了。再针对每一种flavor调参，最后很容易取得高分。 

复赛阶段，第一次提交170+，直接心态就崩了～，后面死活上不了200，还是靠同学给的助攻，最终成绩搞到了224。

## 思路

1. 初赛
- 时间序列规则+动态规划
- 时间序列规则+遗传算法

2. 复赛
- 均值+动态规划



